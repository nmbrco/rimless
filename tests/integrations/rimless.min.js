var rimless=function(t){"use strict";function e(t){return t?void 0!==t.onerror&&void 0!==t.onmessage:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&void 0===self.clients}function n(t){const e=[];return function t(n,r=""){Object.keys(n).forEach(o=>{const i=r?`${r}.${o}`:o;n[o]===Object(n[o])&&t(n[o],i),"function"==typeof n[o]&&e.push(i)})}(t),e}const r=/^(https?:|file:)?\/\/([^/:]+)?(:(\d+))?/,o={"http:":"80","https:":"443"};var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/,a=/^\./,u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,f=/\\(\\)?/g,l=/^\[object .+?Constructor\]$/,p="object"==typeof i&&i&&i.Object===Object&&i,d="object"==typeof self&&self&&self.Object===Object&&self,h=p||d||Function("return this")();var _,v=Array.prototype,y=Function.prototype,g=Object.prototype,E=h["__core-js_shared__"],S=(_=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",m=y.toString,b=g.hasOwnProperty,w=g.toString,R=RegExp("^"+m.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),O=h.Symbol,M=v.splice,j=H(h,"Map"),A=H(Object,"create"),C=O?O.prototype:void 0,L=C?C.toString:void 0;function P(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function $(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function I(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function N(t,e){for(var n,r,o=t.length;o--;)if((n=t[o][0])===(r=e)||n!=n&&r!=r)return o;return-1}function T(t,e){for(var n,r=0,o=(e=function(t,e){if(W(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||V(t))return!0;return s.test(t)||!c.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:W(n=e)?n:k(n)).length;null!=t&&r<o;)t=t[J(e[r++])];return r&&r==o?t:void 0}function D(t){return!(!U(t)||(e=t,S&&S in e))&&(function(t){var e=U(t)?w.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?R:l).test(function(t){if(null!=t){try{return m.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function G(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function H(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return D(n)?n:void 0}P.prototype.clear=function(){this.__data__=A?A(null):{}},P.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},P.prototype.get=function(t){var e=this.__data__;if(A){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return b.call(e,t)?e[t]:void 0},P.prototype.has=function(t){var e=this.__data__;return A?void 0!==e[t]:b.call(e,t)},P.prototype.set=function(t,e){return this.__data__[t]=A&&void 0===e?"__lodash_hash_undefined__":e,this},$.prototype.clear=function(){this.__data__=[]},$.prototype.delete=function(t){var e=this.__data__,n=N(e,t);return!(n<0)&&(n==e.length-1?e.pop():M.call(e,n,1),!0)},$.prototype.get=function(t){var e=this.__data__,n=N(e,t);return n<0?void 0:e[n][1]},$.prototype.has=function(t){return N(this.__data__,t)>-1},$.prototype.set=function(t,e){var n=this.__data__,r=N(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},I.prototype.clear=function(){this.__data__={hash:new P,map:new(j||$),string:new P}},I.prototype.delete=function(t){return G(this,t).delete(t)},I.prototype.get=function(t){return G(this,t).get(t)},I.prototype.has=function(t){return G(this,t).has(t)},I.prototype.set=function(t,e){return G(this,t).set(t,e),this};var k=F((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(V(t))return L?L.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var n=[];return a.test(t)&&n.push(""),t.replace(u,(function(t,e,r,o){n.push(r?o.replace(f,"$1"):e||t)})),n}));function J(t){if("string"==typeof t||V(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function F(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var c=t.apply(this,r);return n.cache=i.set(o,c),c};return n.cache=new(F.Cache||I),n}F.Cache=I;var W=Array.isArray;function U(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function V(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==w.call(t)}var x=function(t,e,n){var r=null==t?void 0:T(t,e);return void 0===r?n:r},K=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,Y=/^\./,q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,z=/\\(\\)?/g,B=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,Z="object"==typeof i&&i&&i.Object===Object&&i,tt="object"==typeof self&&self&&self.Object===Object&&self,et=Z||tt||Function("return this")();var nt=Array.prototype,rt=Function.prototype,ot=Object.prototype,it=et["__core-js_shared__"],ct=function(){var t=/[^.]+$/.exec(it&&it.keys&&it.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),st=rt.toString,at=ot.hasOwnProperty,ut=ot.toString,ft=RegExp("^"+st.call(at).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),lt=et.Symbol,pt=nt.splice,dt=Ot(et,"Map"),ht=Ot(Object,"create"),_t=lt?lt.prototype:void 0,vt=_t?_t.toString:void 0;function yt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function gt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Et(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function St(t,e,n){var r=t[e];at.call(t,e)&&Lt(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function mt(t,e){for(var n=t.length;n--;)if(Lt(t[n][0],e))return n;return-1}function bt(t){return!(!$t(t)||(e=t,ct&&ct in e))&&(function(t){var e=$t(t)?ut.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?ft:B).test(function(t){if(null!=t){try{return st.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function wt(t,e,n,r){if(!$t(t))return t;for(var o=-1,i=(e=function(t,e){if(Pt(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||It(t))return!0;return Q.test(t)||!K.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:function(t){return Pt(t)?t:jt(t)}(e)).length,c=i-1,s=t;null!=s&&++o<i;){var a=At(e[o]),u=n;if(o!=c){var f=s[a];void 0===(u=r?r(f,a,s):void 0)&&(u=$t(f)?f:Mt(e[o+1])?[]:{})}St(s,a,u),s=s[a]}return t}function Rt(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function Ot(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return bt(n)?n:void 0}function Mt(t,e){return!!(e=null==e?9007199254740991:e)&&("number"==typeof t||X.test(t))&&t>-1&&t%1==0&&t<e}yt.prototype.clear=function(){this.__data__=ht?ht(null):{}},yt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},yt.prototype.get=function(t){var e=this.__data__;if(ht){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return at.call(e,t)?e[t]:void 0},yt.prototype.has=function(t){var e=this.__data__;return ht?void 0!==e[t]:at.call(e,t)},yt.prototype.set=function(t,e){return this.__data__[t]=ht&&void 0===e?"__lodash_hash_undefined__":e,this},gt.prototype.clear=function(){this.__data__=[]},gt.prototype.delete=function(t){var e=this.__data__,n=mt(e,t);return!(n<0)&&(n==e.length-1?e.pop():pt.call(e,n,1),!0)},gt.prototype.get=function(t){var e=this.__data__,n=mt(e,t);return n<0?void 0:e[n][1]},gt.prototype.has=function(t){return mt(this.__data__,t)>-1},gt.prototype.set=function(t,e){var n=this.__data__,r=mt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},Et.prototype.clear=function(){this.__data__={hash:new yt,map:new(dt||gt),string:new yt}},Et.prototype.delete=function(t){return Rt(this,t).delete(t)},Et.prototype.get=function(t){return Rt(this,t).get(t)},Et.prototype.has=function(t){return Rt(this,t).has(t)},Et.prototype.set=function(t,e){return Rt(this,t).set(t,e),this};var jt=Ct((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(It(t))return vt?vt.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var n=[];return Y.test(t)&&n.push(""),t.replace(q,(function(t,e,r,o){n.push(r?o.replace(z,"$1"):e||t)})),n}));function At(t){if("string"==typeof t||It(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ct(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var c=t.apply(this,r);return n.cache=i.set(o,c),c};return n.cache=new(Ct.Cache||Et),n}function Lt(t,e){return t===e||t!=t&&e!=e}Ct.Cache=Et;var Pt=Array.isArray;function $t(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function It(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==ut.call(t)}var Nt=function(t,e,n){return null==t?t:wt(t,e,n)},Tt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Dt=new Uint8Array(16);function Gt(){if(!Tt)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Tt(Dt)}for(var Ht,kt,Jt=[],Ft=0;Ft<256;++Ft)Jt[Ft]=(Ft+256).toString(16).substr(1);function Wt(t,e,n){var r=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||Gt)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var i=0;i<16;++i)e[r+i]=o[i];return e||function(t,e){var n=e||0,r=Jt;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}(o)}function Ut(t={},n=[],r,o){const i=[];return n.forEach(n=>{async function c(i){const{action:c,callID:s,connectionID:a,callName:u,args:f=[]}=i.data;if(c!==kt.RPC_REQUEST)return;if(!s||!u)return;if(u!==n)return;if(a!==r)return;const l={action:kt.RPC_RESOLVE,callID:s,callName:u,connectionID:a,error:null,result:null};try{const e=await x(t,n)(...f);l.result=JSON.parse(JSON.stringify(e))}catch(t){l.error=JSON.parse(JSON.stringify(t,Object.getOwnPropertyNames(t)))}o&&o.postMessage?o.postMessage(l):e()?self.postMessage(l):i.source.window===i.source?i.source.postMessage(l,i.origin):i.source.postMessage(l)}o?(o.addEventListener(Ht.MESSAGE,c),i.push(()=>o.removeEventListener(Ht.MESSAGE,c))):(self.addEventListener(Ht.MESSAGE,c),i.push(()=>self.removeEventListener(Ht.MESSAGE,c)))}),()=>{i.forEach(t=>t())}}function Vt(t={},n=[],r,o,i){const c={...t},s=[];return n.forEach(t=>{const n=function(t,n,r,o=[],i){return(...c)=>new Promise((s,a)=>{const u=Wt();function f(e){const{callID:r,connectionID:o,callName:i,result:c,error:f,action:l}=e.data;if(r&&i&&i===t&&o===n&&r===u)return l===kt.RPC_RESOLVE?s(c):l===kt.RPC_REJECT?a(f):void 0}const l={action:kt.RPC_REQUEST,args:JSON.parse(JSON.stringify(c)),callID:u,callName:t,connectionID:n};i?(i.addEventListener(Ht.MESSAGE,f),o.push(()=>i.removeEventListener(Ht.MESSAGE,f))):(self.addEventListener(Ht.MESSAGE,f),o.push(()=>self.removeEventListener(Ht.MESSAGE,f))),i&&i.postMessage?i.postMessage(l):e()?self.postMessage(l):r.source.window===r.source?r.source.postMessage(l,r.origin):r.source.postMessage(l)})}(t,r,o,s,i);Nt(c,t,n)}),{remote:c,unregisterRemote:()=>s.forEach(t=>t())}}!function(t){t.MESSAGE="message"}(Ht||(Ht={})),function(t){t.HANDSHAKE_REQUEST="RIMLESS/HANDSHAKE_REQUEST",t.HANDSHAKE_REPLY="RIMLESS/HANDSHAKE_REPLY",t.RPC_REQUEST="RIMLESS/RPC_REQUEST",t.RPC_RESOLVE="RIMLESS/RPC_RESOLVE",t.RPC_REJECT="RIMLESS/RPC_REJECT"}(kt||(kt={}));var xt={connect:function(t={},r=(e()?self:window.parent),o={}){let i=null,c=!1;const s=r instanceof ServiceWorker?navigator.serviceWorker:self,a=r instanceof ServiceWorker?navigator.serviceWorker:void 0;return new Promise((e,o)=>{const u=n(t);s.addEventListener(Ht.MESSAGE,(function n(o){if(o.data.action!==kt.HANDSHAKE_REPLY)return;if(r!==o.source)return;const i=Ut(t,u,o.data.connectionID,a),{remote:f,unregisterRemote:l}=Vt(o.data.schema,o.data.methods,o.data.connectionID,o,a);return c=!0,e({remote:f,close:()=>{s.removeEventListener(Ht.MESSAGE,n),l(),i()}})}));const f={action:kt.HANDSHAKE_REQUEST,methods:u,schema:JSON.parse(JSON.stringify(t))};i=setInterval(()=>{if(c)return clearInterval(i);r===r.window?r.postMessage(f,"*"):r.postMessage(f)},600),setTimeout(()=>{c||o("connection timeout")},3e3)})}};const Kt=new Map;function Qt(t,e){const n=function(t){const{location:e}=document,n=r.exec(t||"");let i,c,s;return n?[,i=e.protocol,c,,s]=n:(i=e.protocol,c=e.hostname,s=e.port),"file:"===i?"null":`${i}//${c}${s&&s!==o[i]?":"+s:""}`}(t.getAttribute("src")),i=e.origin===n,c=e.source===t.contentWindow;return i&&c}const Yt=(t,{connections:r,messageReceiver:o})=>(i,c)=>{if(!c.source)throw new Error("missing event source");const s=Wt(),a=t&&e(t)?t:void 0,u=n(i),f=Ut(i,u,s,a??o),{remote:l,unregisterRemote:p}=Vt(c.data.schema,c.data.methods,s,c,a??o),d={action:kt.HANDSHAKE_REPLY,connectionID:s,methods:u,schema:JSON.parse(JSON.stringify(i))};t&&c.source===t.contentWindow?c.source.postMessage(d,"*"):c.source.postMessage(d);const h={remote:l,close:()=>{p(),f(),r&&delete r[s]},clientId:c.source!==c.source.window?c.source.id:void 0};return r&&(r[s]=h),h},qt=t=>{const e=Kt.get(t);if(e)return e;const n={},r=new Map,o=new Set,i="undefined"!=typeof ServiceWorkerGlobalScope&&t instanceof ServiceWorkerGlobalScope,c=i?{addEventListener:(t,e)=>{"message"===t&&o.add(e)},removeEventListener:(t,e)=>{"message"===t&&o.delete(e)}}:void 0,s=async t=>{const e=t;if(!e.data||!e.source||!e.origin)throw new Error("unknown message type");if(e.data.action===kt.HANDSHAKE_REQUEST)for(const[t,o]of r){if("undefined"!=typeof HTMLIFrameElement&&t instanceof HTMLIFrameElement&&!Qt(t,e))continue;const r=Yt(t,{connections:n,messageReceiver:c});for(const t of o)t(e,r)}else if(i)for(const t of o)t(e)},a={pendingConnections:0,connect:(t,e,n)=>{a.pendingConnections+=1;let o=r.get(t);o||(o=new Set,r.set(t,o));const i=(t,r)=>{const c=r(e,t);a.pendingConnections=Math.max(a.pendingConnections-1,0),o.delete(i),n(c)};o.add(i)},disconnect:t=>{const e=n[t];e&&e.close()},stop:({shouldCleanupConnections:e=!0}={})=>{if(e)for(const t of Object.values(n))t.close();t.removeEventListener(Ht.MESSAGE,s),Kt.delete(t)}};return Kt.set(t,a),t.addEventListener(Ht.MESSAGE,s),a};var zt={connect:async(t,n={},r)=>{if(!t)throw new Error("a target is required");const o=e(t)?t:window,i=qt(o);return new Promise(e=>{i.connect(t,n,t=>{0===i.pendingConnections&&i.stop({shouldCleanupConnections:!1}),e(t)},r)})},serve:function(t,e={},n){const r=qt(t);let o=!1;return{connections:async function*(){for(;!o;)yield await new Promise(t=>{r.connect(null,e,t,n)})}(),stop:()=>{o=!0,r.stop()}}}};return t.guest=xt,t.host=zt,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=rimless.min.js.map
